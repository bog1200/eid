(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{6069:(e,t,r)=>{Promise.resolve().then(r.bind(r,8973))},8973:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var s=r(2311),a=r(9677),n=r(2847);function o(){let e=(0,a.useSearchParams)(),t=e.get("client_id")||e.get("app"),[r,o]=(0,n.useState)(),[d,i]=(0,n.useState)(!1),[l,c]=(0,n.useState)(""),[h,u]=(0,n.useState)("");return(e.get("error")&&c("Error: "+e.get("error")),(0,n.useEffect)(()=>{!async function(){if(t)try{let e=await fetch("/api/apps/".concat(t));if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let r=await e.json();o(r)}catch(e){console.error("Failed to fetch data:",e),o(null)}}()},[t]),(0,n.useEffect)(()=>{!async function(){if(window.ethereum)try{let[e]=await window.ethereum.request({method:"eth_requestAccounts"});e&&u("did:ethr:".concat(e.toLowerCase()))}catch(e){console.error("Failed to get Ethereum address:",e)}}()},[]),r)?(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-4xl",children:["Login - ",r.name]}),(0,s.jsxs)("h2",{children:[r.name," requests access to the following data:"]}),(0,s.jsx)("ul",{children:r.scopes.map(e=>(0,s.jsxs)("li",{children:[e.name,": ",e.description]},e.name))}),(0,s.jsx)("h2",{children:"Do you want to give access?"}),(0,s.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,s.jsx)("button",{onClick:()=>i(!0),className:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded",children:"Yes"}),(0,s.jsx)("button",{onClick:()=>window.location.replace(r.redirectUri+"?error=denied"),className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded",children:"No"})]}),d&&(0,s.jsx)("div",{className:"my-4",children:(0,s.jsxs)("form",{className:"border-2 border-foreground",action:"/api/identity/startLogin",method:"POST",children:[(0,s.jsx)("label",{className:"text-sm w-full font-bold py-2 px-4 rounded",htmlFor:"did",children:"Username/DID:"}),(0,s.jsx)("input",{type:"hidden",name:"appId",value:t}),(0,s.jsx)("input",{type:"text",id:"did",name:"did",placeholder:"User ID / DID",value:h,onChange:e=>u(e.target.value)}),(0,s.jsx)("button",{className:"w-full bg-green-500 ",type:"submit",children:"Log IN"}),(0,s.jsx)("p",{className:"text-red-500",children:l})]})})]}):(0,s.jsx)("div",{children:"Loading or invalid data..."})}}},e=>{var t=t=>e(e.s=t);e.O(0,[789,20,358],()=>t(6069)),_N_E=e.O()}]);