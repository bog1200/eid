(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{6069:(e,t,s)=>{Promise.resolve().then(s.bind(s,8973))},8973:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var r=s(2311),a=s(9677),n=s(2847);function o(){let e=(0,a.useSearchParams)(),t=e.get("client_id")||e.get("app"),s=e.get("scope")||e.get("scopes"),[o,c]=(0,n.useState)(),[d,i]=(0,n.useState)(!1),[l,h]=(0,n.useState)(""),[u,p]=(0,n.useState)("");return(e.get("error")&&h("Error: "+e.get("error")),(0,n.useEffect)(()=>{!async function(){if(t)try{let e=await fetch("/api/apps/".concat(t,"?scopes=").concat(s));if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let r=await e.json();c(r)}catch(e){console.error("Failed to fetch data:",e),c(null)}}()},[t,s]),(0,n.useEffect)(()=>{!async function(){if(window.ethereum)try{let[e]=await window.ethereum.request({method:"eth_requestAccounts"});e&&p("did:ethr:".concat(e.toLowerCase()))}catch(e){console.error("Failed to get Ethereum address:",e)}}()},[]),o)?(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-4xl",children:["Login - ",o.name]}),(0,r.jsxs)("h2",{children:[o.name," requests access to the following data:"]}),(0,r.jsx)("ul",{children:o.scopes.map(e=>(0,r.jsxs)("li",{children:[e.name,": ",e.description]},e.name))}),(0,r.jsx)("h2",{children:"Do you want to give access?"}),(0,r.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,r.jsx)("button",{onClick:()=>i(!0),className:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded",children:"Yes"}),(0,r.jsx)("button",{onClick:()=>window.location.replace(o.redirectUri+"?error=denied"),className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded",children:"No"})]}),d&&(0,r.jsx)("div",{className:"my-4",children:(0,r.jsxs)("form",{className:"border-2 border-foreground",action:"/api/identity/startLogin",method:"POST",children:[(0,r.jsx)("label",{className:"text-sm w-full font-bold py-2 px-4 rounded",htmlFor:"did",children:"Username/DID:"}),(0,r.jsx)("input",{type:"hidden",name:"appId",value:t}),(0,r.jsx)("input",{type:"text",id:"did",name:"did",placeholder:"User ID / DID",value:u,onChange:e=>p(e.target.value)}),(0,r.jsx)("button",{className:"w-full bg-green-500 ",type:"submit",children:"Log IN"}),(0,r.jsx)("p",{className:"text-red-500",children:l})]})})]}):(0,r.jsx)("div",{children:"Loading or invalid data..."})}}},e=>{var t=t=>e(e.s=t);e.O(0,[789,20,358],()=>t(6069)),_N_E=e.O()}]);